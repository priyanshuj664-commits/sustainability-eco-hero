<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SustainabilityEcoHero</title>
  <meta name="description" content="Gamified sustainability challenge tracker - SustainabilityEcoHero" />
  <style>
    :root{
      --bg:#e6ecff;
      --card:#ffffff;
      --muted:#5b6078;
      --accent:#6366f1; /* Indigo */
      --accent-2:#4338ca; /* Deep Indigo */
      --glass: rgba(255,255,255,0.65);
      --shadow: 0 8px 22px rgba(40, 48, 80, 0.18);
      --radius:16px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#ecfdf5);color:#0f172a;min-height:100vh}
    header{padding:20px 24px;display:flex;align-items:center;justify-content:space-between;gap:16px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;color:white;font-weight:700}
    h1{font-size:18px;margin:0}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    .container{max-width:1100px;margin:0 auto;padding:18px}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:18px}

    /* Card */
    .card{background:var(--card);border-radius:12px;padding:14px;box-shadow:var(--shadow)}
    .controls{display:flex;gap:10px;align-items:center}
    button.btn{background:var(--accent);color:#fff;border:0;padding:8px 12px;border-radius:10px;cursor:pointer}
    button.ghost{background:transparent;border:1px solid #e6eef0;color:var(--accent-2)}

    /* Challenges list */
    .challenges{display:flex;flex-direction:column;gap:10px}
    .challenge{display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:10px;background:linear-gradient(180deg,#ffffff, #f7fffb);border:1px solid #eef7f2}
    .challenge .left{display:flex;gap:12px;align-items:center}
    .badge{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,#ecfccb,#bbf7d0);display:flex;align-items:center;justify-content:center;color:#065f46;font-weight:700}
    .meta{display:flex;flex-direction:column}
    .meta small{color:var(--muted)}
    .complete{background:#10b981;color:white;border-radius:8px;padding:6px 10px;border:0;cursor:pointer}
    .completed-label{color:var(--accent-2);font-weight:700}

    /* Sidebar */
    .sidebar{display:flex;flex-direction:column;gap:12px}
    .progress{display:flex;flex-direction:column;gap:10px}
    .progress-bar{height:12px;background:#e6f4ea;border-radius:10px;overflow:hidden}
    .progress-bar > span{display:block;height:100%;background:linear-gradient(90deg,var(--accent),var(--accent-2));width:0%}
    .stats{display:flex;gap:8px;align-items:center;justify-content:space-between}
    .stat{flex:1;text-align:center;padding:8px;border-radius:8px;background:linear-gradient(180deg,#ffffff,#f8fffb)}

    /* Leaderboard */
    .leaderboard ul{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:8px}
    .leaderboard li{display:flex;align-items:center;gap:10px;padding:8px;border-radius:8px;background:#f8fffb}

    /* Forms */
    .form-row{display:flex;gap:8px}
    input[type=text],select,textarea{padding:8px;border-radius:8px;border:1px solid #e4e7eb;flex:1}

    footer{max-width:1100px;margin:20px auto;padding:12px;color:var(--muted);font-size:13px}

    /* Responsive */
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .sidebar{order:2}
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo">SE</div>
      <div>
        <h1>SustainabilityEcoHero</h1>
        <p class="lead">Gamified sustainability challenges — small steps, big impact</p>
      </div>
    </div>
    <div class="controls">
      <input id="username" type="text" placeholder="Your name" style="padding:8px;border-radius:8px;border:1px solid #e6eef0" />
      <button class="btn" id="saveNameBtn">Set</button>
    </div>
  </header>

  <main class="container">
    <div class="grid">
      <section>
        <div class="card">
          <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px">
            <h2 style="margin:0;font-size:16px">Today's challenges</h2>
            <div style="display:flex;gap:8px">
              <button class="ghost" id="showCreate">+ Create</button>
              <button class="ghost" id="showTips">Tips</button>
            </div>
          </div>

          <div id="challengesList" class="challenges">
            <!-- populated by JS -->
          </div>
        </div>

        <div class="card" style="margin-top:14px">
          <h3 style="margin:0 0 10px 0">Custom challenges</h3>
          <div id="customList" class="challenges"></div>
        </div>

      </section>

      <aside class="sidebar">
        <div class="card progress">
          <h3 style="margin:0">Your progress</h3>
          <div style="display:flex;align-items:center;gap:12px;margin-top:8px">
            <div style="flex:1">
              <div class="progress-bar"><span id="progressFill" style="width:0%"></span></div>
              <div style="display:flex;justify-content:space-between;margin-top:6px"><small id="progressTxt">0/0 tasks</small><small id="pointsTxt">0 pts</small></div>
            </div>
          </div>
          <div style="margin-top:12px;display:flex;gap:8px">
            <div class="stat">
              <div style="font-size:18px;font-weight:700" id="pointsStat">0</div>
              <div style="font-size:12px;color:var(--muted)">Points</div>
            </div>
            <div class="stat">
              <div style="font-size:18px;font-weight:700" id="badgesStat">0</div>
              <div style="font-size:12px;color:var(--muted)">Badges</div>
            </div>
          </div>
        </div>

        <div class="card leaderboard">
          <h3 style="margin:0">Leaderboard</h3>
          <ul id="leaderboardList" style="margin-top:8px"></ul>
          <div style="margin-top:8px;display:flex;gap:8px">
            <button class="ghost" id="resetData">Reset</button>
            <button class="btn" id="shareBtn">Share</button>
          </div>
        </div>

        <div class="card" id="badgesCard">
          <h3 style="margin:0">Badges</h3>
          <div id="badgesArea" style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px"></div>
        </div>
      </aside>
    </div>
  </main>

  <footer>
    Built for learning — customise, extend, and host on GitHub Pages. Want a README and project report? Ask me to generate them.
  </footer>

  <!-- Create modal (simple) -->
  <div id="modal" style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(10,15,12,0.4)">
    <div style="width:92%;max-width:520px;background:var(--card);padding:16px;border-radius:12px;box-shadow:var(--shadow)">
      <h3 style="margin-top:0">Create a custom challenge</h3>
      <div style="display:flex;flex-direction:column;gap:10px">
        <input id="newTitle" type="text" placeholder="Short title, e.g. "Take shorter showers"" />
        <textarea id="newDesc" rows="3" placeholder="Optional description or tips"></textarea>
        <div style="display:flex;gap:8px;justify-content:flex-end">
          <button class="ghost" id="closeModal">Cancel</button>
          <button class="btn" id="createBtn">Create</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Tips modal -->
  <div id="tipsModal" style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(10,15,12,0.35)">
    <div style="width:92%;max-width:720px;background:var(--card);padding:16px;border-radius:12px;box-shadow:var(--shadow)">
      <h3 style="margin-top:0">Tips & Resources</h3>
      <ul style="margin:0;padding-left:18px;color:var(--muted)">
        <li>Turn off lights when not in use — set a timer or motion sensor.</li>
        <li>Reuse containers and buy in bulk to reduce packaging waste.</li>
        <li>Fix leaks — small drips add up. Use a bucket to catch and reuse water temporarily.</li>
        <li>Choose public transport, bike, or walk for short trips.</li>
        <li>Compost kitchen scraps if possible — reduces landfill methane.</li>
      </ul>
      <div style="display:flex;justify-content:flex-end;margin-top:12px">
        <button class="btn" id="closeTips">Close</button>
      </div>
    </div>
  </div>

  <script>
    // --- Sample built-in challenges ---
    const SAMPLE = [
      { id: 'c1', title: 'Switch off unused lights for a day', points: 5, freq: 'daily', desc: 'Turn off lights in empty rooms.' },
      { id: 'c2', title: 'Use public transport or bike', points: 8, freq: 'daily', desc: 'Avoid car use for short trips.' },
      { id: 'c3', title: 'Recycle plastic and paper', points: 6, freq: 'weekly', desc: 'Sort recyclables properly.' },
      { id: 'c4', title: 'Take a shorter shower (≤5 min)', points: 7, freq: 'daily', desc: 'Time your shower to save water.' },
      { id: 'c5', title: 'Avoid single-use plastic for a day', points: 10, freq: 'weekly', desc: 'Bring reusable bag & bottle.' }
    ];

    // --- Persistence keys ---
    const KEY = {
      user: 'eco_user',
      points: 'eco_points',
      comps: 'eco_completions',
      custom: 'eco_custom',
      leaderboard: 'eco_leaderboard'
    };

    // --- App state ---
    let state = {
      user: localStorage.getItem(KEY.user) || 'You',
      points: Number(localStorage.getItem(KEY.points) || 0),
      completions: JSON.parse(localStorage.getItem(KEY.comps) || '{}'),
      custom: JSON.parse(localStorage.getItem(KEY.custom) || '[]'),
      leaderboard: JSON.parse(localStorage.getItem(KEY.leaderboard) || '[]')
    };

    // --- DOM refs ---
    const challengesList = document.getElementById('challengesList');
    const customList = document.getElementById('customList');
    const progressFill = document.getElementById('progressFill');
    const progressTxt = document.getElementById('progressTxt');
    const pointsTxt = document.getElementById('pointsTxt');
    const pointsStat = document.getElementById('pointsStat');
    const badgesStat = document.getElementById('badgesStat');
    const badgesArea = document.getElementById('badgesArea');
    const leaderboardList = document.getElementById('leaderboardList');
    const usernameInput = document.getElementById('username');

    // --- Setup ---
    usernameInput.value = state.user === 'You' ? '' : state.user;

    function saveState(){
      localStorage.setItem(KEY.user, state.user);
      localStorage.setItem(KEY.points, state.points);
      localStorage.setItem(KEY.comps, JSON.stringify(state.completions));
      localStorage.setItem(KEY.custom, JSON.stringify(state.custom));
      localStorage.setItem(KEY.leaderboard, JSON.stringify(state.leaderboard));
    }

    // --- Utility ---
    function mkChallengeNode(ch){
      const div = document.createElement('div');
      div.className = 'challenge';
      const left = document.createElement('div'); left.className = 'left';
      const badge = document.createElement('div'); badge.className='badge'; badge.textContent = ch.points;
      const meta = document.createElement('div'); meta.className='meta';
      const title = document.createElement('div'); title.innerHTML = `<strong>${escapeHtml(ch.title)}</strong>`;
      const small = document.createElement('small'); small.textContent = ch.desc || (ch.freq || 'one-off');
      meta.appendChild(title); meta.appendChild(small);
      left.appendChild(badge); left.appendChild(meta);

      const right = document.createElement('div');
      const done = document.createElement('button');
      const key = ch.id + '|' + todayKey();
      if(state.completions[key]){
        done.textContent = 'Done'; done.className='complete';
      } else {
        done.textContent = 'Complete'; done.className='complete';
      }
      done.addEventListener('click', ()=>toggleComplete(ch));
      right.appendChild(done);

      div.appendChild(left); div.appendChild(right);
      return div;
    }

    function render(){
      // challenges
      challengesList.innerHTML='';
      SAMPLE.forEach(c=>challengesList.appendChild(mkChallengeNode(c)));
      customList.innerHTML='';
      state.custom.forEach(c=>customList.appendChild(mkChallengeNode(c)));

      // progress
      const todayKeys = getTodayChallengeKeys();
      const total = todayKeys.length;
      const done = todayKeys.filter(k=>state.completions[k]).length;
      const pct = total===0?0:Math.round((done/total)*100);
      progressFill.style.width = pct + '%';
      progressTxt.textContent = `${done}/${total} tasks`;
      pointsTxt.textContent = `${state.points} pts`;
      pointsStat.textContent = state.points;

      // badges
      const badges = computeBadges();
      badgesStat.textContent = badges.length;
      badgesArea.innerHTML='';
      badges.forEach(b=>{
        const bdiv = document.createElement('div'); bdiv.className='badge'; bdiv.style.width='48px'; bdiv.style.height='48px'; bdiv.style.fontSize='12px'; bdiv.title=b;
        bdiv.textContent = b[0] || 'B';
        badgesArea.appendChild(bdiv);
      });

      // leaderboard
      renderLeaderboard();
      saveState();
    }

    function toggleComplete(ch){
      const key = ch.id + '|' + todayKey();
      if(state.completions[key]){
        // uncomplete
        delete state.completions[key];
        state.points = Math.max(0, state.points - ch.points);
      } else {
        state.completions[key]= { when: Date.now(), title: ch.title };
        state.points += ch.points;
      }
      updateLeaderboardEntry(state.user, state.points);
      render();
    }

    function computeBadges(){
      const b = [];
      if(state.points>=50) b.push('Eco Champion');
      if(state.points>=20) b.push('Green Contributor');
      if(Object.keys(state.completions).length>0) b.push('Getting Started');
      return b;
    }

    function todayKey(){
      const d = new Date();
      return d.toISOString().slice(0,10); // YYYY-MM-DD
    }

    function getTodayChallengeKeys(){
      const arr = [];
      const today = todayKey();
      // include daily and weekly (weekly we'll treat as available any day)
      SAMPLE.forEach(s=>arr.push(s.id+'|'+today));
      state.custom.forEach(s=>arr.push(s.id+'|'+today));
      return arr;
    }

    function updateLeaderboardEntry(name, pts){
      name = name || 'You';
      const lb = state.leaderboard || [];
      const existing = lb.find(e=>e.name===name);
      if(existing){ existing.points = pts; }
      else lb.push({name, points: pts});
      lb.sort((a,b)=>b.points - a.points);
      state.leaderboard = lb.slice(0,10);
    }

    function renderLeaderboard(){
      leaderboardList.innerHTML='';
      if(!state.leaderboard || state.leaderboard.length===0){
        leaderboardList.innerHTML = '<li style="color:var(--muted)">No entries yet — be the first!</li>';
        return;
      }
      state.leaderboard.forEach((e, i)=>{
        const li = document.createElement('li');
        li.innerHTML = `<div style=\"flex:1\"><strong>${escapeHtml(e.name)}</strong><div style=\"font-size:12px;color:var(--muted)\">${e.points} pts</div></div>`;
        leaderboardList.appendChild(li);
      });
    }

    // --- Simple helpers ---
    function escapeHtml(s){ return String(s).replace(/[&<>"]+/g,m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;' }[m])); }

    // --- Create custom challenge ---
    document.getElementById('showCreate').addEventListener('click',()=>document.getElementById('modal').style.display='flex');
    document.getElementById('closeModal').addEventListener('click',()=>document.getElementById('modal').style.display='none');
    document.getElementById('createBtn').addEventListener('click',()=>{
      const t = document.getElementById('newTitle').value.trim();
      const d = document.getElementById('newDesc').value.trim();
      if(!t) return alert('Give your challenge a short title');
      const ch = { id: 'u' + Date.now(), title: t, desc: d, points: 5 };
      state.custom.unshift(ch);
      document.getElementById('newTitle').value=''; document.getElementById('newDesc').value='';
      document.getElementById('modal').style.display='none';
      render();
    });

    // Tips modal
    document.getElementById('showTips').addEventListener('click',()=>document.getElementById('tipsModal').style.display='flex');
    document.getElementById('closeTips').addEventListener('click',()=>document.getElementById('tipsModal').style.display='none');

    // username set
    document.getElementById('saveNameBtn').addEventListener('click',()=>{
      const v = usernameInput.value.trim();
      if(v){ state.user = v; updateLeaderboardEntry(state.user, state.points); render(); }
      else { alert('Enter a name to show on the leaderboard'); }
    });

    // reset
    document.getElementById('resetData').addEventListener('click',()=>{
      if(!confirm('Clear all local progress?')) return;
      localStorage.removeItem(KEY.points); localStorage.removeItem(KEY.comps); localStorage.removeItem(KEY.custom); localStorage.removeItem(KEY.leaderboard);
      state.points=0; state.completions={}; state.custom=[]; state.leaderboard=[]; render();
    });

    // share
    document.getElementById('shareBtn').addEventListener('click', async ()=>{
      const msg = `${state.user} has ${state.points} points on SustainabilityEcoHero! Try it: (host this app or copy the HTML)`;
      if(navigator.share){
        try{ await navigator.share({title:'SustainabilityEcoHero',text:msg}); }
        catch(e){ alert('Share cancelled'); }
      } else {
        await navigator.clipboard.writeText(msg);
        alert('Progress copied to clipboard — share it with friends!');
      }
    });

    // init sample leaderboard if empty
    if(!state.leaderboard || state.leaderboard.length===0){
      state.leaderboard = [{name:'GreenTeam',points:30},{name:'EcoAlex',points:18}];
    }

    // initial render
    render();

    // small autosave every 10s
    setInterval(saveState, 10000);
  </script>
</body>
</html>

